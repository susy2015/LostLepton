#include "CMS_lumi.h"

void Plot_acc_eff_sb()
{
 double err_acc_mu[84];
 double err_acc_el[84];

double ttbar_mus_acc[84] = {0.779773,0.832505,0.840979,0.920001,0.921199,0.779561,0.782069,0.827096,0.865559,0.848526,0.809515,0.830239,0.859169,0.950661,0.934137,0.835547,0.834985,0.782232, 0.89492243531,0.89071,0.901287,0.808267,0.841113,0.850027,0.818748,0.856226,0.801145,0.73131,0.816932,0.813908,0.810219,0.842129,0.898327,0.91341, 0.91043337621,0.88409, 0.97418830223,0.796223,0.753082,0.706515,0.939679,0.871432,0.857424,0.880219,0.75096,0.918375,0.871487,0.935829,0.917782,0.944366,0.974012,0.947048,0.814746,0.891508,0.918283,0.909631,0.695693,0.921032,0.905964,0.924945,0.970734,0.944811,0.813426,0.833078,0.931086,0.899564,0.80025, 0.82047963016,0.964979,0.776139,0.882155,0.874795,0.979999,0.877562,0.907341,0.8997,0.896413, 0.90930870628,0.903941,0.954756,0.972532, 0.94218343391,0.97479,0.987531};

  double ttbar_els_acc[84] = {0.796254,0.817056,0.855315,0.86969,0.867518,0.797272,0.788632,0.784897,0.896617,0.844784,0.786448,0.784488,0.786469,0.930664,0.900305,0.868238,0.804818,0.883506, 0.93320706193, 0.83426129727,0.856737,0.805324,0.821121,0.883425,0.797658,0.861103,0.808384,0.810101,0.861552,0.91929,0.910047,0.855063,0.905816,0.787223, 0.85112667746, 0.77518837147, 0.84849465786,0.761023,0.820352,0.86683,0.682317,0.859753,0.853176,0.808622,0.809811,0.883197,0.900257, 0.82463828449,0.898533,0.881737,0.908247,0.84891,0.787378,0.806865,0.907253,0.795525,0.83343,0.835343,0.908375,0.882189,0.908209,0.953873,0.802342,0.8337,0.844538,0.832989,0.740961, 0.8734481425,0.957411,0.775336,0.835947,0.706598, 0.74145254081,0.812405,0.959356,0.918329,0.908634, 0.93422740776,0.92556,0.937496,0.921839, 0.90199894693,0.942854, 0.91250998935};

err_acc_mu[0] = 0.0035432859067;
err_acc_mu[1] = 0.012839018389;
err_acc_mu[2] = 0.024820221371;
err_acc_mu[3] = 0.030104749992;
err_acc_mu[4] = 0.017210193584;
err_acc_mu[5] = 0.0045668611466;
err_acc_mu[6] = 0.015353826211;
err_acc_mu[7] = 0.027992805303;
err_acc_mu[8] = 0.036416251895;
err_acc_mu[9] = 0.0098315996173;
err_acc_mu[10] = 0.013170016062;
err_acc_mu[11] = 0.026025064314;
err_acc_mu[12] = 0.035302939529;
err_acc_mu[13] = 0.018874241372;
err_acc_mu[14] = 0.023579734381;
err_acc_mu[15] = 0.029739469971;
err_acc_mu[16] = 0.030523062244;
err_acc_mu[17] = 0.063125831382;
err_acc_mu[18] = 0.084798158551;
err_acc_mu[19] = 0.074097102445;
err_acc_mu[20] = 0.029167471739;
err_acc_mu[21] = 0.0047281412259;
err_acc_mu[22] = 0.014494427957;
err_acc_mu[23] = 0.029336511589;
err_acc_mu[24] = 0.043812973463;
err_acc_mu[25] = 0.077279846782;
err_acc_mu[26] = 0.0145253304;
err_acc_mu[27] = 0.038872437136;
err_acc_mu[28] = 0.059462588967;
err_acc_mu[29] = 0.080160392298;
err_acc_mu[30] = 0.049599620533;
err_acc_mu[31] = 0.030796028534;
err_acc_mu[32] = 0.036036883511;
err_acc_mu[33] = 0.030249071912;
err_acc_mu[34] = 0.03354365435;
err_acc_mu[35] = 0.06857889332;
err_acc_mu[36] = 0.12970766837;
err_acc_mu[37] = 0.012538706471;
err_acc_mu[38] = 0.029573610381;
err_acc_mu[39] = 0.065997537374;
err_acc_mu[40] = 0.052641673032;
err_acc_mu[41] = 0.015659699539;
err_acc_mu[42] = 0.026946640907;
err_acc_mu[43] = 0.035584424492;
err_acc_mu[44] = 0.089867044584;
err_acc_mu[45] = 0.0076301284588;
err_acc_mu[46] = 0.040796126629;
err_acc_mu[47] = 0.01758572619;
err_acc_mu[48] = 0.0079820636347;
err_acc_mu[49] = 0.013735264654;
err_acc_mu[50] = 0.0063135509433;
err_acc_mu[51] = 0.016139549726;
err_acc_mu[52] = 0.016999708174;
err_acc_mu[53] = 0.023049105864;
err_acc_mu[54] = 0.02960371208;
err_acc_mu[55] = 0.032902185969;
err_acc_mu[56] = 0.09384458214;
err_acc_mu[57] = 0.032841872945;
err_acc_mu[58] = 0.0084906231221;
err_acc_mu[59] = 0.016766348464;
err_acc_mu[60] = 0.0079040042436;
err_acc_mu[61] = 0.018335917727;
err_acc_mu[62] = 0.02002354673;
err_acc_mu[63] = 0.037516659232;
err_acc_mu[64] = 0.032470367687;
err_acc_mu[65] = 0.027820326445;
err_acc_mu[66] = 0.091955202993;
err_acc_mu[67] = 0.1220939941;
err_acc_mu[68] = 0.018684875043;
err_acc_mu[69] = 0.10195202889;
err_acc_mu[70] = 0.029997354728;
err_acc_mu[71] = 0.05681868728;
err_acc_mu[72] = 0.012061951569;
err_acc_mu[73] = 0.03139316958;
err_acc_mu[74] = 0.037506854382;
err_acc_mu[75] = 0.025812440621;
err_acc_mu[76] = 0.043134778619;
err_acc_mu[77] = 0.02268678966;
err_acc_mu[78] = 0.062091446645;
err_acc_mu[79] = 0.019037839016;
err_acc_mu[80] = 0.0090157036384;
err_acc_mu[81] = 0.024575513814;
err_acc_mu[82] = 0.013423503467;
err_acc_mu[83] = 0.010052523365;
err_acc_el[0] = 0.0034182590159;
err_acc_el[1] = 0.013332568119;
err_acc_el[2] = 0.023615969483;
err_acc_el[3] = 0.035330602343;
err_acc_el[4] = 0.034311280181;
err_acc_el[5] = 0.004450749196;
err_acc_el[6] = 0.015192049175;
err_acc_el[7] = 0.030073066373;
err_acc_el[8] = 0.025557711507;
err_acc_el[9] = 0.0096349116832;
err_acc_el[10] = 0.013727745316;
err_acc_el[11] = 0.02533754851;
err_acc_el[12] = 0.04097984506;
err_acc_el[13] = 0.021666599299;
err_acc_el[14] = 0.030923121248;
err_acc_el[15] = 0.024450965699;
err_acc_el[16] = 0.033653611435;
err_acc_el[17] = 0.06184896814;
err_acc_el[18] = 0.03332030009;
err_acc_el[19] = 0.026195310091;
err_acc_el[20] = 0.047186882064;
err_acc_el[21] = 0.0047428730145;
err_acc_el[22] = 0.015492061413;
err_acc_el[23] = 0.0226763966;
err_acc_el[24] = 0.051146031052;
err_acc_el[25] = 0.063908861527;
err_acc_el[26] = 0.013825478876;
err_acc_el[27] = 0.031268037223;
err_acc_el[28] = 0.042353742506;
err_acc_el[29] = 0.033051599344;
err_acc_el[30] = 0.030384226261;
err_acc_el[31] = 0.029524029445;
err_acc_el[32] = 0.030856457607;
err_acc_el[33] = 0.078593513537;
err_acc_el[34] = 0.048204826717;
err_acc_el[35] = 0.1547975903;
err_acc_el[36] = 0.034676770434;
err_acc_el[37] = 0.013483400528;
err_acc_el[38] = 0.026087333771;
err_acc_el[39] = 0.047652173177;
err_acc_el[40] = 0.14827332763;
err_acc_el[41] = 0.017072267329;
err_acc_el[42] = 0.028627187587;
err_acc_el[43] = 0.053161325652;
err_acc_el[44] = 0.064891129958;
err_acc_el[45] = 0.009467602769;
err_acc_el[46] = 0.012015461592;
err_acc_el[47] = 0.032867141724;
err_acc_el[48] = 0.008438913767;
err_acc_el[49] = 0.021288059327;
err_acc_el[50] = 0.03450410151;
err_acc_el[51] = 0.071361696361;
err_acc_el[52] = 0.019540336464;
err_acc_el[53] = 0.030605137363;
err_acc_el[54] = 0.026070327191;
err_acc_el[55] = 0.050083169365;
err_acc_el[56] = 0.06130088516;
err_acc_el[57] = 0.08690263446;
err_acc_el[58] = 0.0084776764936;
err_acc_el[59] = 0.02369218938;
err_acc_el[60] = 0.03790639829;
err_acc_el[61] = 0.014669988967;
err_acc_el[62] = 0.020586053913;
err_acc_el[63] = 0.036916594073;
err_acc_el[64] = 0.055304841741;
err_acc_el[65] = 0.038260708758;
err_acc_el[66] = 0.097510009333;
err_acc_el[67] = 0.024849478178;
err_acc_el[68] = 0.02166674228;
err_acc_el[69] = 0.11323683835;
err_acc_el[70] = 0.032860518619;
err_acc_el[71] = 0.099531793972;
err_acc_el[72] = 0.034506848115;
err_acc_el[73] = 0.043907835389;
err_acc_el[74] = 0.010152794587;
err_acc_el[75] = 0.011458364448;
err_acc_el[76] = 0.017684739623;
err_acc_el[77] = 0.019574080151;
err_acc_el[78] = 0.028654386429;
err_acc_el[79] = 0.023594520607;
err_acc_el[80] = 0.034700124959;
err_acc_el[81] = 0.079093472676;
err_acc_el[82] = 0.024627583904;
err_acc_el[83] = 0.051163917911;

 const std::string titre="CMS Supplementary";

  TCanvas *c1 = new TCanvas("c1", "c1",0,51,1920,1004);
  c1->SetFillColor(0);
  c1->cd();

  TH1D *h_mu_iso_eff = new TH1D("h_mu_iso_eff", "h_mu_iso_eff", 84 , 0 , 84);
  h_mu_iso_eff->SetTitle("");
  h_mu_iso_eff->SetXTitle("Search region bin number");
  h_mu_iso_eff->SetYTitle("acceptance");
  h_mu_iso_eff->SetStats(0);
  h_mu_iso_eff->SetLineWidth(3);
  h_mu_iso_eff->SetMinimum(0.0);

  for (Int_t sbc=1;sbc<=84;++sbc) {
    h_mu_iso_eff->SetBinContent(sbc,ttbar_mus_acc[sbc-1]);
    h_mu_iso_eff->SetBinError(sbc,err_acc_mu[sbc-1]);
    //h_mu_iso_eff->SetBinContent(sbc,sbc);
  }

  gStyle->SetPaintTextFormat("1.2f");
  h_mu_iso_eff->Draw();

  TH1D *h_e_iso_eff = new TH1D("h_e_iso_eff", "h_e_iso_eff", 84 , 0 , 84);
  h_e_iso_eff->SetLineColor(2);
  h_e_iso_eff->SetLineWidth(3);

  for (Int_t sbc=1;sbc<=84;++sbc) {
    h_e_iso_eff->SetBinContent(sbc,ttbar_els_acc[sbc-1]);
    h_e_iso_eff->SetBinError(sbc,err_acc_el[sbc-1]);
    //h_mu_iso_eff->SetBinContent(sbc,sbc);
  }
  h_e_iso_eff->Draw("same");


//  TLatex *title = new TLatex(0.09770115,0.9194915,titre.c_str());
//  title->SetNDC();
//  title->SetTextSize(0.045);
//  title->Draw("same");
//
//   TLatex *   tex2 = new TLatex(0.8127615,0.9178645,"(13 TeV)");
//tex2->SetNDC();
//   tex2->SetTextSize(0.045);
//   tex2->SetLineWidth(2);
//   tex2->Draw();
   CMSStylePlot::CMS_lumi( c1, 0, 0 );


  TLegend* leg = new TLegend(0.6,0.15,0.9,0.27);
  leg->SetBorderSize(0);
  leg->SetTextFont(42);
  leg->SetFillColor(0);
  leg->AddEntry(h_mu_iso_eff,"Muons","l");
  leg->AddEntry(h_e_iso_eff,"Electrons","l");
  leg->Draw("same");


  c1->SaveAs( "acc_eff_84bins.pdf" );

}
