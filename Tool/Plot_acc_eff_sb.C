#include "CMS_lumi.h"

void Plot_acc_eff_sb()
{
 double err_acc[84];
 double err_acc_el[84];

  double ttbar_mus_acc[84] = {0.786234,0.822463,0.886602,0.879236,1,0.787969,0.775839,0.8841,0.690224,0.854566,0.802813,0.825511,0.813072,1,0.914055,0.767431,0.850478,0.602709,0,0.837038,1,0.799989,0.827317,0.869197,0.807359,0.928909,0.785622,0.738928,0.612461,0.832386,0.827155,0.800097,0.894208,1,1,1,1,0.781121,0.739791,0.688583,0.889833,0.870301,0.7986,0.863024,0.71043,0.710368,0.895237,0.900872,0.920006,0.948714,0.891483,1,0.814637,0.888574,0.854853,0.900947,0.813257,0.779833,0.906128,0.932288,0.919432,1,0.796002,0.85854,0.909132,0.78121,0.809668,0.887021,0.881403,0.714269,0.889667,0.864314,0.830539,0.891072,0.884134,0.937101,0.95153,0.753132,0.924033,1,0.901018,0.742546,0.901175,1};

  double ttbar_els_acc[84] = {0.797943,0.822011,0.8429,0.862011,0.864936,0.796302,0.765946,0.765395,0.819545,0.830343,0.768141,0.710589,0.823704,0.802691,0.916974,0.833808,0.708699,1,1,0.5,0.831371,0.79589,0.798956,0.867366,0.772635,0.915027,0.802141,0.82461,0.862235,0.898141,0.799688,0.853561,0.832255,0.744714,0,1,1,0.757073,0.80247,0.817188,0.564219,0.842516,0.815661,0.848664,0.832144,0.798772,0.935327,1,0.887297,0.903554,0.910744,0.931906,0.780746,0.795312,0.894093,0.820841,0.779334,1,0.906114,0.894115,0.913667,0.871678,0.804007,0.825769,0.864553,0.780806,0.765975,1,0.856118,0.751562,0.856912,0.712481,1,0.821383,0.974243,0.811245,0.942974,1,0.960457,0.915741,0.886351,0.801355,0.907281,1};

err_acc[0] = 0.003276405755;
err_acc[1] = 0.014482691003;
err_acc[2] = 0.029126968919;
err_acc[3] = 0.057151979068;
err_acc[4] = 0.090456982065;
err_acc[5] = 0.0043817268216;
err_acc[6] = 0.018438285584;
err_acc[7] = 0.036720053023;
err_acc[8] = 0.085373102483;
err_acc[9] = 0.011009123312;
err_acc[10] = 0.016026997747;
err_acc[11] = 0.035051499011;
err_acc[12] = 0.094552603651;
err_acc[13] = 0.16960684137;
err_acc[14] = 0.053666201627;
err_acc[15] = 0.053575030768;
err_acc[16] = 0.070018826594;
err_acc[17] = 0.32351608395;
err_acc[18] = 0;
err_acc[19] = 0.26479636657;
err_acc[20] = 0.1356854731;
err_acc[21] = 0.0044866766909;
err_acc[22] = 0.016727972947;
err_acc[23] = 0.035549208172;
err_acc[24] = 0.064183418658;
err_acc[25] = 0.12237720576;
err_acc[26] = 0.014771146901;
err_acc[27] = 0.041155479519;
err_acc[28] = 0.14003732671;
err_acc[29] = 0.15848846442;
err_acc[30] = 0.054986253674;
err_acc[31] = 0.044664433247;
err_acc[32] = 0.080453274053;
err_acc[33] = 0.16960684137;
err_acc[34] = 1.356854731;
err_acc[35] = 0.22614245516;
err_acc[36] = 0.67842736548;
err_acc[37] = 0.012345905879;
err_acc[38] = 0.032770242207;
err_acc[39] = 0.07881321614;
err_acc[40] = 0.11006181759;
err_acc[41] = 0.024406760431;
err_acc[42] = 0.052536083361;
err_acc[43] = 0.10029503765;
err_acc[44] = 0.15680407314;
err_acc[45] = 0.077556649355;
err_acc[46] = 0.077883126213;
err_acc[47] = 0.16744414982;
err_acc[48] = 0.0079787661121;
err_acc[49] = 0.01847369768;
err_acc[50] = 0.058460774515;
err_acc[51] = 0.16960684137;
err_acc[52] = 0.014862898624;
err_acc[53] = 0.029781014678;
err_acc[54] = 0.062111906854;
err_acc[55] = 0.053111155815;
err_acc[56] = 0.085338990611;
err_acc[57] = 0.20298752426;
err_acc[58] = 0.008850978825;
err_acc[59] = 0.020903386965;
err_acc[60] = 0.062022403741;
err_acc[61] = 0.16960684137;
err_acc[62] = 0.01915420658;
err_acc[63] = 0.040133160587;
err_acc[64] = 0.069055532109;
err_acc[65] = 0.043505217466;
err_acc[66] = 0.11167230066;
err_acc[67] = 0.18440894175;
err_acc[68] = 0.11597453142;
err_acc[69] = 0.15680407314;
err_acc[70] = 0.029589800325;
err_acc[71] = 0.071389610488;
err_acc[72] = 0.26479636657;
err_acc[73] = 0.040687738603;
err_acc[74] = 0.086136582749;
err_acc[75] = 0.064188256475;
err_acc[76] = 0.087162921197;
err_acc[77] = 0.37298610151;
err_acc[78] = 0.05761982463;
err_acc[79] = 0.15076163677;
err_acc[80] = 0.075471702164;
err_acc[81] = 0.37298610151;
err_acc[82] = 0.16744414982;
err_acc[83] = 0.22614245516;
err_acc_el[0] = 0.0032460756619;
err_acc_el[1] = 0.015197060231;
err_acc_el[2] = 0.035016627906;
err_acc_el[3] = 0.065592705373;
err_acc_el[4] = 0.10029503765;
err_acc_el[5] = 0.0043369549737;
err_acc_el[6] = 0.01860378567;
err_acc_el[7] = 0.041586332734;
err_acc_el[8] = 0.07474834252;
err_acc_el[9] = 0.011570743313;
err_acc_el[10] = 0.017083993517;
err_acc_el[11] = 0.042116871343;
err_acc_el[12] = 0.073098953681;
err_acc_el[13] = 0.30972485952;
err_acc_el[14] = 0.063643097459;
err_acc_el[15] = 0.044739374543;
err_acc_el[16] = 0.074902341664;
err_acc_el[17] = 0.1356854731;
err_acc_el[18] = 1.356854731;
err_acc_el[19] = 0.64221975518;
err_acc_el[20] = 0.26479636657;
err_acc_el[21] = 0.0045329988022;
err_acc_el[22] = 0.019406332498;
err_acc_el[23] = 0.039507055557;
err_acc_el[24] = 0.091145249528;
err_acc_el[25] = 0.14141190065;
err_acc_el[26] = 0.014275052166;
err_acc_el[27] = 0.034448809559;
err_acc_el[28] = 0.10029503765;
err_acc_el[29] = 0.16744414982;
err_acc_el[30] = 0.057020308839;
err_acc_el[31] = 0.043573951152;
err_acc_el[32] = 0.07000695601;
err_acc_el[33] = 0.22387937809;
err_acc_el[34] = 0;
err_acc_el[35] = 1.356854731;
err_acc_el[36] = 0.33921368274;
err_acc_el[37] = 0.013169715064;
err_acc_el[38] = 0.030956754794;
err_acc_el[39] = 0.069753535106;
err_acc_el[40] = 0.25746433808;
err_acc_el[41] = 0.026842630108;
err_acc_el[42] = 0.052783881363;
err_acc_el[43] = 0.079156973496;
err_acc_el[44] = 0.15848846442;
err_acc_el[45] = 0.066410840237;
err_acc_el[46] = 0.066159059914;
err_acc_el[47] = 0.27137094619;
err_acc_el[48] = 0.0087341642296;
err_acc_el[49] = 0.022251934934;
err_acc_el[50] = 0.04865646361;
err_acc_el[51] = 0.11465858215;
err_acc_el[52] = 0.017297138803;
err_acc_el[53] = 0.030640423393;
err_acc_el[54] = 0.057306615671;
err_acc_el[55] = 0.051506067127;
err_acc_el[56] = 0.082974427191;
err_acc_el[57] = 0.16960684137;
err_acc_el[58] = 0.0086736253674;
err_acc_el[59] = 0.024343923584;
err_acc_el[60] = 0.054762784697;
err_acc_el[61] = 0.12255620759;
err_acc_el[62] = 0.020297050449;
err_acc_el[63] = 0.044791750952;
err_acc_el[64] = 0.08132160016;
err_acc_el[65] = 0.038599571827;
err_acc_el[66] = 0.13373057492;
err_acc_el[67] = 0.33921368274;
err_acc_el[68] = 0.23122387924;
err_acc_el[69] = 0.14064691325;
err_acc_el[70] = 0.030782213055;
err_acc_el[71] = 0.085557048661;
err_acc_el[72] = 0.19383639014;
err_acc_el[73] = 0.051506067127;
err_acc_el[74] = 0.046770787257;
err_acc_el[75] = 0.085338990611;
err_acc_el[76] = 0.096411941481;
err_acc_el[77] = 0.67842736548;
err_acc_el[78] = 0.070300278617;
err_acc_el[79] = 0.14141190065;
err_acc_el[80] = 0.054162093177;
err_acc_el[81] = 0.30972485952;
err_acc_el[82] = 0.15333284977;
err_acc_el[83] = 0.45228491032;

 const std::string titre="CMS Supplementary";

  TCanvas *c1 = new TCanvas("c1", "c1",0,51,1920,1004);
  c1->SetFillColor(0);
  c1->cd();

  TH1D *h_mu_iso_eff = new TH1D("h_mu_iso_eff", "h_mu_iso_eff", 84 , 0 , 84);
  h_mu_iso_eff->SetTitle("");
  h_mu_iso_eff->SetXTitle("Search region bin number");
  h_mu_iso_eff->SetYTitle("acceptance");
  h_mu_iso_eff->SetStats(0);
  h_mu_iso_eff->SetLineWidth(3);
  h_mu_iso_eff->SetMinimum(0.0);

  for (Int_t sbc=1;sbc<=84;++sbc) {
    h_mu_iso_eff->SetBinContent(sbc,ttbar_mus_acc[sbc-1]);
    h_mu_iso_eff->SetBinError(sbc,err_acc[sbc-1]);
    //h_mu_iso_eff->SetBinContent(sbc,sbc);
  }

  gStyle->SetPaintTextFormat("1.2f");
  h_mu_iso_eff->Draw();

  TH1D *h_e_iso_eff = new TH1D("h_e_iso_eff", "h_e_iso_eff", 84 , 0 , 84);
  h_e_iso_eff->SetLineColor(2);
  h_e_iso_eff->SetLineWidth(3);

  for (Int_t sbc=1;sbc<=84;++sbc) {
    h_e_iso_eff->SetBinContent(sbc,ttbar_els_acc[sbc-1]);
    h_e_iso_eff->SetBinError(sbc,err_acc_el[sbc-1]);
    //h_mu_iso_eff->SetBinContent(sbc,sbc);
  }
  h_e_iso_eff->Draw("same");


//  TLatex *title = new TLatex(0.09770115,0.9194915,titre.c_str());
//  title->SetNDC();
//  title->SetTextSize(0.045);
//  title->Draw("same");
//
//   TLatex *   tex2 = new TLatex(0.8127615,0.9178645,"(13 TeV)");
//tex2->SetNDC();
//   tex2->SetTextSize(0.045);
//   tex2->SetLineWidth(2);
//   tex2->Draw();
   CMSStylePlot::CMS_lumi( c1, 0, 0 );


  TLegend* leg = new TLegend(0.6,0.15,0.9,0.27);
  leg->SetBorderSize(0);
  leg->SetTextFont(42);
  leg->SetFillColor(0);
  leg->AddEntry(h_mu_iso_eff,"Muons","l");
  leg->AddEntry(h_e_iso_eff,"Electrons","l");
  leg->Draw("same");


  c1->SaveAs( "acc_eff_84bins.pdf" );

}
